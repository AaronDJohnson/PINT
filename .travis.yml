# This is the config file for travis-ci for PINT

language: python

matrix:
    fast_finish: true
    include:
        - script: wget https://data.nanograv.org/static/data/ephem/de405.bsp
          name: "NANOGrav ephemeris server accessible"
          install: []
          services: []
          after_success: []
          git:
              clone: false
        - python: "2.7"
        - python: "3.5"
        - python: "3.6"
        - python: "3.7"
        - script: make docs-build
          name: "Documentation build"
          after_success: []
          # FIXME: eventually can turn warnings into errors so Travis will fail 
          # on dead links and formatting problems; right now we have a bazillion
          # dead links and formatting problems.
        - script: flake8-diff
          name: "python style checker for changed code"
          services: []
          after_success: []
          before_script: git fetch --unshallow
sudo: required

# https://docs.travis-ci.com/user/gui-and-headless-browsers/#Using-xvfb-to-Run-Tests-That-Require-a-GUI
#before_script:
#    - "export DISPLAY=:99.0"
#    - "sh -e /etc/init.d/xvfb start"
#    - sleep 3 # give xvfb some time to start

services:
    - xvfb

install:
    # We need to require the dev requirements first in case they're more
    # stringent (on version numbers)
    - pip install -r requirements_dev.txt
    - pip install -r requirements.txt
    - pip install .

#script:
#    - pwd
#    - make test

script:
    - ( cd tests && pytest --cov=pint )

after_success:
    ( cd tests && coveralls )

